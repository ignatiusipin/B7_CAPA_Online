<script src="https://unpkg.com/gojs/release/go-debug.js" defer></script>
<div class="card">
    <div class="card-body">
        <h4 class="card-title">Analisa Kondisi</h4>
        <div class="table-responsive">
            <table class="table table-bordered zero-configuration" id="tblAnalisaKondisi">
                <thead>
                    <tr>
                        <th>Aspect</th>
                        <th>WHAT SHOULD BE HAPPENED</th>
                        <th>WHAT ACTUALLY HAPPENED</th>
                        <th>OK/NOK</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    </div>
</div>
<div class="col-md-1">
    <input type="button" class="btn btn-primary" id="ShowDiag" data-toggle="modal" data-target="#Modal_Diag" data-backdrop="static" value="Show Diagram"/>
</div>
<br />
<div class="modal fade" id="Modal_Diag" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Filter</h5>
            </div>
            <div class="modal-body">
                <div id="DiagManusia"
                     style="width:100%; height:300px; background-color: #DAE4E4;"></div>
                <br />

                <div id="DiagMaterial"
                     style="width:100%; height:300px; background-color: #DAE4E4;"></div>
                <br />
                <div id="DiagLingkungan"
                     style="width:100%; height:300px; background-color: #DAE4E4;"></div>
                <br />

                <div id="DiagMesin"
                     style="width:100%; height:300px; background-color: #DAE4E4;"></div>
                <br />

                <div id="DiagMetode"
                     style="width:100%; height:300px; background-color: #DAE4E4;"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btn_Close_Diag">Close</button>
            </div>
        </div>
    </div>
</div>
<script>
    $(document).ready(function () {
        GetRootManusia();
        GetRootMaterial();
        GetRootLingkungan();
        GetRootMesin();
        GetRootMetode();
        GetAnalisaKondisi();
        $('#ShowDiag').click(function () {
            $('#Modal_Diag').attr("hidden", false);
        });
    });

    function GetRootManusia() {

        $.ajax({
            type: "POST",
            url: "../Koordinator/GetRoot?NoCapa=CPA/SIA/HOF/MK/0921/009&Type=Manusia",
            dataType: 'json',
            async: true,
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                var result = JSON.parse(data);
                var $ = go.GraphObject.make;

                var myDiagram =
                    $(go.Diagram, "DiagManusia", 
                        {
                            "undoManager.isEnabled": true,
                            contentAlignment: go.Spot.Center,
                            layout: $(go.TreeLayout, // specify a Diagram.layout that arranges trees
                                { angle: 90, layerSpacing: 35 })
                        });


                myDiagram.nodeTemplate =
                    $(go.Node, "Horizontal",
                        { background: "#44CCFF", locationSpot: go.Spot.Center},
                        $(go.TextBlock, "Default Text",
                            {
                                margin: 10, width: 75, height: 25, stroke: "white", font: "bold 16px sans-serif", textAlign: "center", wrap: go.TextBlock.WrapFit,
                                verticalAlignment: go.Spot.Center
                            },
                            new go.Binding("text", "type")),
                        $(go.TextBlock, "Default Text",
                            {
                                margin: 10, stroke: "white", font: "bold 16px sans-serif", textAlign: "center", wrap: go.TextBlock.WrapFit,
                                verticalAlignment: go.Spot.Center
                            },
                            new go.Binding("text", "desc"))
                    );

                myDiagram.model = new go.TreeModel(result);
            }
        });
    }
    function GetRootMaterial() {

        $.ajax({
            type: "POST",
            url: "../Koordinator/GetRoot?NoCapa=CPA/SIA/HOF/MK/0921/009&Type=Material/Produk",
            async: true,
            dataType: 'json',
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                var result = JSON.parse(data);
                var $ = go.GraphObject.make;

                var myDiagram =
                    $(go.Diagram, "DiagMaterial",
                        {
                            "undoManager.isEnabled": true,
                            contentAlignment: go.Spot.Center,
                            layout: $(go.TreeLayout, // specify a Diagram.layout that arranges trees
                                { angle: 90, layerSpacing: 35 })

                        });


                myDiagram.nodeTemplate =
                    $(go.Node, "Horizontal",
                        { background: "#44CCFF" },
                        $(go.TextBlock, "Default Text",
                            {
                                margin: 10, width: 75, height: 50, stroke: "white", font: "bold 16px sans-serif", textAlign: "center", wrap: go.TextBlock.WrapFit,
                                verticalAlignment: go.Spot.Center
                            },
                            new go.Binding("text", "type")),
                        $(go.TextBlock, "Default Text",
                            {
                                margin: 10, stroke: "white", font: "bold 16px sans-serif", textAlign: "center", wrap: go.TextBlock.WrapFit,
                                verticalAlignment: go.Spot.Center
                            },
                            new go.Binding("text", "desc"))
                    );

                myDiagram.model = new go.TreeModel(result);
            }
        });
    }
    function GetRootLingkungan() {

        $.ajax({
            type: "POST",
            url: "../Koordinator/GetRoot?NoCapa=CPA/SIA/HOF/MK/0921/009&Type=Lingkungan",
            dataType: 'json',
            async: true,
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                var result = JSON.parse(data);
                var $ = go.GraphObject.make;

                var myDiagram =
                    $(go.Diagram, "DiagLingkungan",
                        {
                            "undoManager.isEnabled": true,
                            contentAlignment: go.Spot.Center,
                            layout: $(go.TreeLayout, // specify a Diagram.layout that arranges trees
                                { angle: 90, layerSpacing: 35 })
                        });


                myDiagram.nodeTemplate =
                    $(go.Node, "Horizontal",
                        { background: "#44CCFF" },
                        $(go.TextBlock, "Default Text",
                            {
                                margin: 10, width: 75, height: 25, stroke: "white", font: "bold 16px sans-serif", textAlign: "center", wrap: go.TextBlock.WrapFit,
                                verticalAlignment: go.Spot.Center
                            },
                            new go.Binding("text", "type")),
                        $(go.TextBlock, "Default Text",
                            {
                                margin: 10, stroke: "white", font: "bold 16px sans-serif", textAlign: "center", wrap: go.TextBlock.WrapFit,
                                verticalAlignment: go.Spot.Center
                            },
                            new go.Binding("text", "desc"))
                    );

                myDiagram.model = new go.TreeModel(result);
            }
        });
    }
    function GetRootMesin() {

        $.ajax({
            type: "POST",
            url: "../Koordinator/GetRoot?NoCapa=CPA/SIA/HOF/MK/0921/009&Type=Mesin",
            dataType: 'json',
            async: true,
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                var result = JSON.parse(data);
                var $ = go.GraphObject.make;

                var myDiagram =
                    $(go.Diagram, "DiagMesin",
                        {
                            "undoManager.isEnabled": true,
                            contentAlignment: go.Spot.Center,
                            layout: $(go.TreeLayout, // specify a Diagram.layout that arranges trees
                                { angle: 90, layerSpacing: 35 })
                        });


                myDiagram.nodeTemplate =
                    $(go.Node, "Horizontal",
                        { background: "#44CCFF" },
                        $(go.TextBlock, "Default Text",
                            {
                                margin: 10, width: 75, height: 25, stroke: "white", font: "bold 16px sans-serif", textAlign: "center", wrap: go.TextBlock.WrapFit,
                                verticalAlignment: go.Spot.Center
                            },
                            new go.Binding("text", "type")),
                        $(go.TextBlock, "Default Text",
                            {
                                margin: 10, stroke: "white", font: "bold 16px sans-serif", textAlign: "center", wrap: go.TextBlock.WrapFit,
                                verticalAlignment: go.Spot.Center
                            },
                            new go.Binding("text", "desc"))
                    );

                myDiagram.model = new go.TreeModel(result);
            }
        });
    }
    function GetRootMetode() {

        $.ajax({
            type: "POST",
            url: "../Koordinator/GetRoot?NoCapa=CPA/SIA/HOF/MK/0921/009&Type=Metode",
            dataType: 'json',
            async: true,
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                var result = JSON.parse(data);
                var $ = go.GraphObject.make;

                var myDiagram =
                    $(go.Diagram, "DiagMetode",
                        {
                            "undoManager.isEnabled": true,
                            contentAlignment: go.Spot.Center,
                            layout: $(go.TreeLayout, // specify a Diagram.layout that arranges trees
                                { angle: 90, layerSpacing: 35 })
                        });


                myDiagram.nodeTemplate =
                    $(go.Node, "Horizontal",
                        { background: "#44CCFF" },
                        $(go.TextBlock, "Default Text",
                            {
                                margin: 10, width: 75, height: 25, stroke: "white", font: "bold 16px sans-serif", textAlign: "center", wrap: go.TextBlock.WrapFit,
                                verticalAlignment: go.Spot.Center
                            },
                            new go.Binding("text", "type")),
                        $(go.TextBlock, "Default Text",
                            {
                                margin: 10, stroke: "white", font: "bold 16px sans-serif", textAlign: "center", wrap: go.TextBlock.WrapFit,
                                verticalAlignment: go.Spot.Center
                            },
                            new go.Binding("text", "desc"))
                    );

                myDiagram.model = new go.TreeModel(result);
            }
        });
    }
    function GetAnalisaKondisi() {
        $.ajax({
            type: "POST",
            url: "../Koordinator/GetAnalisa?NoCapa=CPA/SIA/HOF/MK/0921/009",
            dataType: 'json',
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                var table = $('#tblAnalisaKondisi').DataTable({
                    "pageLength": 5,
                    "lengthChange": false,
                    "searching": false,
                    "data": JSON.parse(data),
                    "destroy": true,
                    "columns": [
                        { "data": "WAHType" },
                        { "data": "WSBHDesc" },
                        { "data": "WAHDesc" },
                        { "data": "WAHStatus" },


                    ],
                    "order": [[0, 'asc']],
                });

            }
        });
    }



</script>