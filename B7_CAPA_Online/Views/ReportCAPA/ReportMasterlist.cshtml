
@{
    ViewBag.Title = "ReportMasterlist";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="content-body">
    <div class="row page-titles mx-0">
        <div class="col p-md-0">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="javascript:void(0)">Dashboard</a></li>
                <li class="breadcrumb-item active"><a href="javascript:void(0)">Report Masterlist</a></li>
            </ol>
        </div>
    </div>
    <!-- row -->

    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-12">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title">Report Masterlist</h4>
                        <div class="row form-group-sm">
                            <div class="col-md-6">
                                <label class="m-t-20">Status CAPA<span style="color: red">*</span></label>
                                <select class="form-control select2" id="Status">
                                   
                                </select>
                            </div>
                        </div>
                        <div class="row form-group-sm">
                            <div class="col-md-6">
                                <label class="m-t-20">Departemen PIC CAPA<span style="color: red">*</span></label>
                                <select class="form-control select2" id="Departemen">
                                </select>
                            </div>
                        </div>
                        <div class="row form-group-sm">
                            <div class="col-md-6">
                                <label class="m-t-20">Kategori<span style="color: red">*</span></label>
                                <select class="form-control select2" id="Kategori">
                                    
                                </select>
                            </div>
                        </div>
                        <div class="row form-group-sm">
                            <div class="col-md-6">
                                <label class="m-t-20">Kode CAPA<span style="color: red">*</span></label>
                                <select class="form-control select2" id="Kode_CAPA">
                                </select>
                            </div>
                        </div>
                        <div class="row form-group-sm">
                            <div class="col-md-6">
                                <label class="m-t-20">Tahun<span style="color: red">*</span></label>
                                <select class="form-control select2" id="Tahun">
                                </select>
                            </div>
                        </div>
                        <div class="row form-group-sm">
                            <div class="col-md-6">
                                <label class="m-t-20">Lokasi Site<span style="color: red">*</span></label>
                                <select class="form-control select2" id="Lokasi">
                                </select>
                            </div>
                        </div>
                        <div class="row form-group-sm mt-3">
                            <div class="col-md-6">
                                <button class="btn btn-primary">Filter</button>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-bordered zero-configuration">
                                <thead>
                                    <tr>
                                        <th>Created Date</th>
                                        <th>No CAPA</th>
                                        <th>PIC CAPA</th>
                                        <th>Departemen</th>
                                        <th>Site</th>
                                        <th>Requestor CAPA</th>
                                        <th>Kategori CAPA</th>                                        
                                        <th>Status</th>
                                        <th>Outstanding</th>
                                        <th>Tanggal Closed</th>
                                        <th>Alasan Cancelled</th>
                                        <th>Tanggal Cancelled</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>29 Juni 2021</td>
                                        <td>CPA/QXX/AAA/BB/CCDD/EEE</td>
                                        <td>Arya Saloka</td>
                                        <td>Produksi</td>
                                        <td>Cikarang</td>
                                        <td>Andriani Devi</td>
                                        <td>Kualitas produk</td>
                                        <td>Waiting Approval Koordinator</td>
                                        <td>Tri Pamulatsih</td>
                                        <td>29 Juli 2021</td>
                                        <td>N/A</td>
                                        <td>N/A</td>               
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- #/ container -->
</div>
<script>

      $(document).ready(function () {
        getKodeCAPA();

    });

    function getKodeCAPA()
    {
        var dictlist = {
            Option:"Kode CAPA"
        }
        var dto = {
            Model: dictlist
        }
        $.ajax({
            url: "DynamicController?spname=SP_Report",
            type: "POST",
            dataType: "json",
            data: JSON.stringify(dto),
            contentType: "application/json;charset=utf-8",
            success: function (data) {

                $('#Kode_CAPA').empty();
                var result = JSON.parse(data);
                for (var i = 0; i < result.length; i++) {
                    $('#Kode_CAPA').append(new Option(result[i].Code_Desc, result[i].Code));
                }

                getDepartemen();
                }, error: function (ex) {
                alert(JSON.stringify(ex));
            }
        });

    }
    function getDepartemen() {
        var dictlist = {
            Option: "Departemen"
        }
        var dto = {
            Model: dictlist
        }
        $.ajax({
            url: "DynamicController?spname=SP_Report",
            type: "POST",
            dataType: "json",
            data: JSON.stringify(dto),
            contentType: "application/json;charset=utf-8",
            success: function (data) {

                var result = JSON.parse(data);
                $('#Departemen').empty();

                $('#Departemen').append('<option disabled selected hidden class="dropdown-header">--Please Select--</option>');
                for (var i = 0; i < result.length; i++) {
                    $('#Departemen').append(new Option(result[i].PlantDesc, result[i].PlantID));
                }

                getLokasi();
            }, error: function (ex) {
                alert(JSON.stringify(ex));
            }
        });

    }


    function getLokasi() {
        var dictlist = {
            Option: "Lokasi"
        }
        var dto = {
            Model: dictlist
        }
        $.ajax({
            url: "DynamicController?spname=SP_Report",
            type: "POST",
            dataType: "json",
            data: JSON.stringify(dto),
            contentType: "application/json;charset=utf-8",
            success: function (data) {
                var result = JSON.parse(data);
                $('#Lokasi').empty();

                $('#Lokasi').append('<option disabled selected hidden class="dropdown-header">--Please Select--</option>');
                for (var i = 0; i < result.length; i++) {
                    $('#Lokasi').append(new Option(result[i].DDL_CODE, result[i].DDL_DESCRIPTION));
                }

                getStatusCAPA();
            }, error: function (ex) {
                alert(JSON.stringify(ex));
            }
        });

    }

    function getStatusCAPA() {
        var dictlist = {
            Option: "Status CAPA"
        }
        var dto = {
            Model: dictlist
        }
        $.ajax({
            url: "DynamicController?spname=SP_Report",
            type: "POST",
            dataType: "json",
            data: JSON.stringify(dto),
            contentType: "application/json;charset=utf-8",
            success: function (data) {

                var result = JSON.parse(data);
                $('#Status').empty();

                $('#Status').append('<option disabled selected hidden class="dropdown-header">--Please Select--</option>');
                for (var i = 0; i < result.length; i++) {
                    $('#Status').append(new Option(result[i].STATUS_ID, result[i].STATUS_CAPA));
                }
                getKategori();
            }, error: function (ex) {
                alert(JSON.stringify(ex));
            }
        });

    }


    function getKategori() {
        var dictlist = {
            Option: "Kategori"
        }
        var dto = {
            Model: dictlist
        }
        $.ajax({
            url: "DynamicController?spname=SP_Report",
            type: "POST",
            dataType: "json",
            data: JSON.stringify(dto),
            contentType: "application/json;charset=utf-8",
            success: function (data) {

                var result = JSON.parse(data);
                $('#Kategori').empty();

                $('#Kategori').append('<option disabled selected hidden class="dropdown-header">--Please Select--</option>');
                for (var i = 0; i < result.length; i++) {
                    $('#Kategori').append(new Option(result[i].DDL_DESCRIPTION, result[i].DDL_CODE));
                }

            }, error: function (ex) {
                alert(JSON.stringify(ex));
            }
        });

    }


</script>
